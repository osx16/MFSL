<!DOCTYPE html>
<html>
<head>
</head>
<body>
    <ol class="breadcrumb">
        <li class="active"><i class="glyphicon glyphicon-info-sign"></i> | Update File Status</li>
    </ol>

    <section class="content">
        <div class="row">
            <div class="box">
                <div class="box-header">
                </div>
                <div class="box-body">
                    <table class="table">
                        <thead>
                            <tr>
                                <td align="right">
                                    <input type="number" min="1" id="txtbox" class="form-control" placeholder="Enter File Number" />
                                </td>
                                <td align="left">
                                    <input type="submit" id="search" value="search" class="btn btn-success" disabled="disabled" />
                                </td>
                            </tr>
                        </thead>
                    </table>
                    <div id="edit-container"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Button trigger modal -->
    <div class="modal fade" id="successAlertModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div style="width:800px; margin:0 auto;" aria-hidden="true" class="alert alert-dismissable alert-success">
                <button type="button" class="close" data-dismiss="alert">×</button>
                <h4><i class="glyphicon glyphicon-ok"></i> File updated</h4>
            </div>
        </div>

    </div>

    <!-- Button trigger modal -->
    <div class="modal fade" id="pendingAlertModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div style="width:800px; margin:0 auto;" aria-hidden="true" class="alert alert-dismissable alert-danger">
                <button type="button" class="close" data-dismiss="alert">×</button>
                <h4><i class="glyphicon glyphicon-remove"></i>Oops!</h4>

                <p>Your file is still in progress. You can only change the status when it's finalized.</p>
            </div>
        </div>
    </div>

    <!-- Button trigger modal -->
    <div class="modal fade" id="serverAlertModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div style="width:800px; margin:0 auto;" aria-hidden="true" class="alert alert-dismissable alert-danger">
                <button type="button" class="close" data-dismiss="alert">×</button>
                <h4><i class="glyphicon glyphicon-remove"></i>Oops! Something went wrong.</h4>

                <p>Check your internet connection. If the problem continues to persist please contact support.</p>
            </div>
        </div>
    </div>

    <script src="~/Scripts/jquery-3.1.1.min.js"></script>
    <script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"></script>
    <script src="~/Scripts/bootstrap.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script type="text/javascript">
        $(function () {
            $.ajaxPrefilter(function (options, original_Options, jqXHR) {
                options.async = true;
            });

            $('#edit-container').load('@Url.Action("RenderInfoView", "UpdateFiles")');
            document.getElementById("txtbox").onkeyup = function () {
                if ($(this).val() == 0) {
                    $('.btn').prop('disabled', true);
                } else {
                    $('.btn').prop('disabled', false);
                }
            }

            $('#search').unbind().click(function (e) {
                e.preventDefault();
                $("#edit-container").load('@(Url.Action("GetFileByFileNo", "UpdateFiles",null, Request.Url.Scheme))?fileNo=' + $('#txtbox').val());
            });

            $(function () {
                var status = '@(ViewBag.Status)';
                console.log("status: " + status);
                if (status == "error") {
                    $('#serverAlertModal').modal('show');
                }
                else if (status == "Pending") {
                    alert("In Pending Modal Block");
                    $('#pendingAlertModal').modal('show');
                }
                var confirmationStatus = parseInt(@ViewBag.Confirmation);
                if (confirmationStatus == 0) {
                    $('#failureAlertModal').modal('show');
                }
                else if (confirmationStatus == 1) {
                    $('#successAlertModal').modal('show');
                }
            });

        });

    </script>
</body>
</html>